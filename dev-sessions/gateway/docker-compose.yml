services:
  dev-sessions-gateway:
    container_name: ${DEV_SESSIONS_GATEWAY_CONTAINER_NAME:-dev-sessions-gateway}
    build:
      context: .
    restart: unless-stopped
    ports:
      - "${DEV_SESSIONS_GATEWAY_PORT:-6767}:6767"
    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      SSH_USER: "${SSH_USER:?Set SSH_USER in dev-sessions/gateway/.env}"
      SSH_HOST: "${SSH_HOST:-host.docker.internal}"
      SSH_PORT: "${SSH_PORT:-22}"
      MAX_SESSIONS_PER_CREATOR: "${MAX_SESSIONS_PER_CREATOR:-10}"
    volumes:
      - "${CLAUDE_GATEWAY_SSH_KEY_PATH:?Set CLAUDE_GATEWAY_SSH_KEY_PATH in dev-sessions/gateway/.env}:/root/.ssh/id_ed25519:ro"
      - "${DEV_SESSIONS_DB_PATH:?Set DEV_SESSIONS_DB_PATH in dev-sessions/gateway/.env}:/data/sessions.db"
